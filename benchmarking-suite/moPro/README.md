# MoPro - Mobile Zero-Knowledge Proof Framework

This directory contains the **MoPro (Mobile Proving)** implementation for the Deimos benchmarking suite, enabling zero-knowledge proof generation and verification on mobile devices.

## Overview

MoPro is a framework that brings zero-knowledge proof capabilities to mobile platforms by providing:
- **Cross-platform support** for iOS, Android, and Web
- **Multiple ZK backends** including Circom, Halo2, and Noir
- **Performance benchmarking** tools for mobile ZK operations
- **Native bindings** through Rust FFI and UniFFI

## Architecture

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Kotlin/Swift  │───▶│   Rust FFI       │───▶│  ZK Circuits    │
│   (Mobile App)  │    │   (UniFFI)       │    │  (Circom/Halo2) │
└─────────────────┘    └──────────────────┘    └─────────────────┘
```

## Directory Structure

```
moPro/
├── mopro-sha256/                 # Main MoPro implementation
│   ├── src/
│   │   └── lib.rs               # Rust library with ZK proof functions
│   ├── android/                 # Android application
│   │   └── app/src/main/java/   # Kotlin integration code
│   ├── MoproAndroidBindings/    # Generated FFI bindings
│   ├── test-vectors/            # Test data for circuits
│   ├── Cargo.toml              # Rust dependencies
│   └── README.md               # Detailed setup instructions
```

## Key Components

### 1. **Rust Core (`src/lib.rs`)**
- **Circuit Integration**: Connects to Circom SHA256 circuit
- **FFI Functions**: Exports proof generation/verification via UniFFI
- **Multi-Backend Support**: Configurable for different ZK systems

### 2. **Android Integration (`android/`)**
- **Performance Benchmarking**: Comprehensive metrics collection
- **UI Components**: Material Design interface for testing
- **Memory Monitoring**: Real-time resource usage tracking
- **Batch Processing**: Automated benchmark runs

### 3. **Generated Bindings (`MoproAndroidBindings/`)**
- **Type-Safe FFI**: Auto-generated Kotlin bindings
- **Memory Management**: Safe Rust ↔ Kotlin data transfer
- **Error Handling**: Proper exception propagation


## Circuit Implementation

### SHA256 Circuit (Circom)
```circom
template Main(N) {
    signal input in[N];      // 32-byte preimage
    signal input hash[32];   // Expected SHA256 hash
    signal output out[32];   // Computed hash
    
    // Proves knowledge of preimage without revealing it
    component sha256 = Sha256Bytes(N);
    sha256.in <== in;
    out <== sha256.out;
    
    // Constraint: computed hash must equal expected hash
    for (var i = 0; i < 32; i++) {
        out[i] === hash[i];
    }
}
```

## Performance Benchmarking

The Android app provides comprehensive benchmarking capabilities:

### Metrics Collected
- **Proving Time**: Circuit execution and proof generation
- **Verification Time**: Proof validation duration  
- **Memory Usage**: RAM consumption during operations
- **Proof Size**: Generated proof size in bytes
- **Success Rate**: Percentage of successful operations

### Benchmark Features
- **Single Run**: Individual proof generation test
- **Batch Processing**: Automated multiple runs with statistics
- **Framework Comparison**: Side-by-side performance analysis
- **Real-time Monitoring**: Live performance metrics display

## Getting Started

### Prerequisites
```bash
# Install Rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Install MoPro CLI
git clone https://github.com/zkmopro/mopro
cd mopro/cli
cargo install --path .
```

### Setup
```bash
cd mopro-sha256

# Initialize MoPro configuration
mopro init

# Build native bindings
mopro build

# Generate platform templates
mopro create

# Update bindings after changes
mopro update
```

### Running Tests
```bash
# Run Rust tests
cargo test

# Test specific circuit
cargo test test_circom
```

### Android Development
```bash
# Open in Android Studio
open android -a Android\ Studio

# Or build from command line
cd android
./gradlew build
```

## Integration Example

### Kotlin Usage
```kotlin
// Generate proof
val input = """{"in": [...], "hash": [...]}"""
val proofResult = generateCircomProof(zkeyPath, input, ProofLib.ARKWORKS)

// Verify proof
val isValid = verifyCircomProof(zkeyPath, proofResult, ProofLib.ARKWORKS)
```

### Rust FFI Functions
```rust
// Auto-generated by mopro_ffi::app!() macro
- generate_circom_proof()
- verify_circom_proof()  
- generate_halo2_proof()
- verify_halo2_proof()
- generate_noir_proof()
- verify_noir_proof()
```

## Use Cases

### Privacy-Preserving Authentication
- Prove knowledge of password without revealing it
- Zero-knowledge identity verification
- Private credential systems

### Blockchain Integration  
- Mobile wallet proof generation
- Layer 2 scaling solutions
- Private transaction validation

### Performance Research
- Mobile ZK proof benchmarking
- Cross-platform performance analysis
- Resource optimization studies

## Configuration

### Cargo Features
```toml
[features]
default = ["mopro-ffi/circom"]
# Optional: "mopro-ffi/halo2", "mopro-ffi/noir"
```

### Build Configuration
- **Library Types**: `lib`, `cdylib`, `staticlib`
- **UniFFI Version**: `0.29.0` (pinned for compatibility)
- **Target Platforms**: Android, iOS, Web

## Resources

- **MoPro Documentation**: https://zkmopro.org
- **Circom Language**: https://docs.circom.io
- **UniFFI Guide**: https://mozilla.github.io/uniffi-rs
- **Community**: 
  - Twitter: [@zkmopro](https://twitter.com/zkmopro)
  - Telegram: [@zkmopro](https://t.me/zkmopro)

## Contributing

1. **Circuit Development**: Add new circuits in `src/`
2. **Platform Support**: Extend bindings for new platforms  
3. **Performance Optimization**: Improve mobile proof generation
4. **Documentation**: Enhance setup and usage guides

## License

This implementation follows the MoPro project licensing and integrates with the broader Deimos benchmarking framework.
